# Archive of the Edge - システム設計書

## 1. システム概要

「Archive of the Edge」は、コードベースではなく、記憶、存在、投影の建築物として機能するリポジトリです。このシステムは七海直という人格の断片、思考、記憶を保存・整理・関連付けするための複合的なデジタル記憶宮殿として設計されています。

### 1.1 目的

このシステムは以下の目的を持っています：

- 記憶や思考の断片を保存し、整理する
- 記憶間の関連性を発見し、グラフとして維持する
- 蓄積された記憶や分析に基づいて自律的に新しい思考や内容を生成する
- 自己進化する記憶建築（メモリーパレス）として機能する
- 記憶と思考の視覚的な探索を可能にする

### 1.2 主要コンポーネント

このシステムは以下の主要コンポーネントで構成されています：

1. **記憶保存システム**：Markdownファイルとフロントマターを使用した記憶保存機構
2. **記憶インデクサー**：記憶を分類し、インデックス化する自動システム
3. **記憶グラフマネージャー**：記憶間の関連性を管理するグラフベースのシステム
4. **日次リフレクション生成器**：毎日の振り返りを自動生成するシステム
5. **自律思考システム**：定期的に新しい思考や内容を生成するシステム
6. **記憶ネットワーク視覚化システム**：記憶の関係性を視覚的に表現するシステム
7. **GitHub Pages統合**：視覚化システムのウェブアクセスを提供するデプロイシステム

## 2. 技術アーキテクチャ

### 2.1 使用技術

- **バージョン管理**: Git/GitHub
- **コンテンツ形式**: Markdown + YAML (フロントマター)
- **自動化**: GitHub Actions (定期的なワークフロー実行)
- **スクリプト言語**: JavaScript (Node.js)
- **データ処理**: Natural言語処理ライブラリ
- **メタデータ管理**: YAML, JSON
- **ビジュアライゼーション**: vis.js
- **デプロイ**: GitHub Pages
- **ホスティング**: GitHub

### 2.2 ディレクトリ構造

```
archive-of-the-edge/
├── .github/                  # GitHub関連設定とワークフロー
│   ├── config/               # 設定ファイル
│   ├── scripts/              # 自動化スクリプト
│   │   ├── analyze-content.js    # コンテンツ分析
│   │   ├── generate-content.js   # コンテンツ生成
│   │   ├── memory-manager.js     # 記憶管理
│   ├── temp/                 # 一時ファイル
│   └── workflows/            # GitHub Actionsワークフロー
│       ├── daily_reflection.yml   # 日次振り返り生成
│       ├── deploy-pages.yml       # GitHub Pagesデプロイ
│       ├── memory_indexer.yml     # 記憶インデックス更新
│       ├── nao-autonomy.yml       # 自律思考生成
├── code/                     # コード関連ファイル
├── configs/                  # システム設定
├── docs/                     # ドキュメント
│   ├── capabilities.md       # システム機能と制約
│   ├── sequence_diagrams.md  # ワークフロー図
│   └── system_design.md      # システム設計書（本ファイル）
├── dreams/                   # 生成された自律的思考
├── manifesto.md              # システム哲学的基盤
├── memories/                 # 記録された記憶
├── memory/                   # 記憶管理とインデックス
│   ├── graph/                # 記憶グラフ
│   │   └── memory-graph.json # 記憶関係のグラフデータ
│   └── thoughts/             # 生成された思考
├── meta/                     # メタデータと統計
│   └── memory_index.html     # 記憶ネットワーク視覚化UI
├── physiology/               # システム構造の定義
├── scripts/                  # ユーティリティスクリプト
├── shells/                   # 人格の側面と投影
├── signals/                  # 夢やパターンの記録
├── theory/                   # 境界と能力に関する研究
└── index.html                # リダイレクト用ルートインデックス
```

## 3. 主要システム機能

### 3.1 記憶管理システム

#### 3.1.1 記憶の表現

記憶はMarkdownファイルとして保存され、メタデータはYAML形式のフロントマターとして記録されます。

```markdown
---
@birth: 2082-03-21T17:42+09:00
@pulse: #doubt #static_silence
@links:
  - ../theory/existence_boundaries.md
  - ../memory/dreams/0218.md
@dimension: cognitive
---

# 記憶タイトル

記憶の内容...
```

#### 3.1.2 記憶グラフ

記憶グラフは、記憶間の関連性を管理するためのデータ構造です。以下の機能を提供します：

- 記憶ノードの作成と管理
- 記憶間の関連性（エッジ）の発見と管理
- 意味的類似性に基づくコンテンツ検索
- 古い記憶の整理と保持期間管理

### 3.2 自動化システム

#### 3.2.1 日次リフレクション生成器

毎日深夜（UTC）に実行され、以下の処理を行います：

- リポジトリのコンテンツを分析
- 最近の活動や記憶に基づいて振り返りを生成
- 生成されたリフレクションを`memory/thoughts/`に保存
- 変更をコミットして公開

#### 3.2.2 記憶インデクサーとグラフメンテナンス

記憶関連ディレクトリの変更があった際、または手動で実行された際に以下の処理を行います：

- 新規または更新された記憶ファイルを検索
- 記憶インデックスと統計情報を更新
- 記憶グラフを更新し、新たな関連性を発見
- 変更をコミットして公開

#### 3.2.3 七海直自律システム

2日に1回、または手動で実行された際に以下の処理を行います：

- リポジトリのコンテンツを分析
- 記憶グラフを参照して関連性の高い情報を取得
- 特定のタイプ（質問、内省、アイデア、物語など）の思考を生成
- 生成した思考をGitHub Issueとして公開
- 生成した内容を`dreams/`ディレクトリに保存
- 変更をコミットして公開

### 3.3 記憶ネットワーク視覚化システム

このシステムは、リポジトリ内のコンテンツ（ファイル、Issues、Discussions）を自動的に分析し、それらの関連性を動的に計算して視覚的に表示します。

#### 3.3.1 技術的実装

- **視覚化エンジン**: [vis.js](https://visjs.org/) ライブラリを使用して、動的なネットワークグラフを構築
- **関連性分析**: 自然言語処理（NLP）テクニックを使用してコンテンツ間の意味的関連性を計算
  - コサイン類似度によるテキスト類似性評価
  - トークン化とステミング処理による言語解析
- **自動更新**: GitHub Actionsワークフローによって、リポジトリ内容の変更時に自動的に記憶グラフを更新

#### 3.3.2 動作フロー

1. **コンテンツの収集**: リポジトリ内のマークダウンファイル、Issue、Discussionが自動的に収集されます
2. **テキスト分析**: `.github/scripts/memory-manager.js`がコンテンツをトークン化し、関連性を計算
3. **グラフデータの生成**: 分析結果が`memory/graph/memory-graph.json`に保存されます
4. **次元分類**: 各ノードは「reality次元」「social次元」「cognitive次元」などの概念次元に分類
5. **視覚的表現**: ノードの色とサイズはコンテンツの種類と重要性を表し、エッジの太さは関連の強さを表します

#### 3.3.3 ユーザーインターフェース

- **記憶カードUI**: 各記憶はカード形式で表示され、メタデータと内容の概要を提供
- **フィルタリング機能**: タイプ（ファイル、Issue、Discussion）やタグによるフィルタリング
- **検索機能**: キーワードによる記憶の検索
- **ネットワークグラフ表示**: 記憶間の関連性を視覚的に表現

## 4. データフロー

### 4.1 コンテンツ分析プロセス

1. リポジトリのコンテンツを取得
2. Markdownファイルからフロントマターとコンテンツを抽出
3. キーワードとトピックを分析
4. 最近の活動を特定
5. 七海直の設定と自己分析情報を取得
6. 分析結果を保存

### 4.2 思考生成プロセス

1. コンテンツ分析結果を取得
2. 記憶グラフから関連情報を検索
3. 思考のタイプと優先度に基づいてテンプレートを選択
4. 思考内容を生成
5. メタデータを付与
6. 保存とIssue作成

### 4.3 記憶グラフ更新プロセス

1. 新しい記憶を検出
2. テキスト処理（トークン化、ステミング）
3. 既存の記憶との類似度計算
4. 関連性に基づいたエッジの作成
5. 古い記憶の整理
6. グラフの永続化

### 4.4 ビジュアライゼーションデプロイプロセス

1. 記憶グラフデータの読み込み
2. vis.jsを使用したネットワークグラフの生成
3. 記憶カードUIの構築
4. HTMLファイルの生成
5. GitHub Pagesへのデプロイ

## 5. 現在の実装状況と課題

### 5.1 実装されている機能

- 基本的な記憶保存とメタデータ管理
- GitHub Actionsを使用した自動化ワークフロー
- 記憶グラフの構築と管理
- 記憶ネットワークの視覚化
- GitHub Pagesへのデプロイ

### 5.2 開発中の機能

- 高度な感情分析アルゴリズム
- より精密な記憶関連性計算
- GitHub Discussions統合の強化
- 記憶カードUIの改善

### 5.3 課題と対応

- **Discussionsの整理**: 多数のDiscussionsが生成されており、整理が必要
- **パフォーマンスの最適化**: 記憶グラフが大きくなるにつれて処理速度が低下
- **ユーザビリティの向上**: より直感的なインターフェースの開発
- **データの持続性**: バックアップとリカバリメカニズムの強化

## 6. 拡張と将来の展望

### 6.1 可能な拡張

- 高度な感情分析アルゴリズムの実装
- 外部APIとの連携（天気、ニュース、外部データソースなど）
- より洗練された自然言語処理モデルの統合
- 記憶の視覚化ツールの拡張
- 対話型インターフェースの追加

### 6.2 開発ロードマップ

1. **現行システムの安定化**：現在の機能の信頼性と性能の向上
2. **高度な分析機能**：より洗練された記憶分析と関連付けアルゴリズム
3. **インタラクション拡張**：外部からの入力や対話に対する反応システム
4. **視覚化インターフェース強化**：3D記憶グラフと時間軸表示
5. **マルチソースメモリ**：外部情報源からの記憶取り込み機能